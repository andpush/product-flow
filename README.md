
# AI-first Product Development Flow for Claude Code

The Flow facilitates AI Assisted Development by defining:

- Templates
- Slash Commands
- Agent Hooks
- Sub-Agents
- Rules files for various tech stacks

That together make AI Agent to drive the development process on all phases of SDLC.

```mermaid
graph TB
    IN[Initial vision and BA files in
    ./product/initial-docs/] 
        -->|/define-product| PR[product.md]
    
    
    PR-->|/mockup-product|PM[ /product/mockups/ ]
    IN--> PM

    IN -->|/define-architecture| AR[architecture.md]
    
    PR --> |/define-feature| F[features/F000-FeatureName/feature.md]

    F --> |/mockup-feature| FM[features/F000-FeatureName/mockups]

    F-->|/plan-feature| FP[plan.md]
    FM-->FP
    AR-->FP

    FP-->|/implement-feature| FB[branch w. Code & Tests]
    FB-->|/feature-review|FB
    
```

## Product Definition

### Agent purpose at this phase

Based on the files in /product/inital-product/ folder, such as:

- Problem domain definition
- Market Research
- Solution Ideation
- Recrorded meetings conversations with stakeholders
- Business Requirements / Use Cases / User Journey Map
- Vision of the MVP

generates directory structure and detailed functional requirements.

The agent able to find gaps and contradictions and ask clarifying questions to ensure consistency by involving human in the loop.

### Template for product.md

```text
---
Product Name:
Creation Date:
Status:
---
# Product Definition

## Product Purpose

The What

## Target Audience

The Who

## Problem Solved

The Why

## Concise Solution Description: 

The How

## Competitors 

## UVP

## Concerns, Risks and Limitations



## UI/UX Considerations

Define:

- The required type of UI (if any): mobile, web, other;
- Reference design(s) in the form of links or screenshots;
- Styling and design system if requested;

## Non-functional Requirements

Define if there any expectations:

- Internationalization
- Peformance related: Response time, latency
- Scalability related: User growth, Data volume, Geo-distribution
- Avalability: uptime requriements, fault tolerance, backups
- Security & Compliance: data protection, authentication, audit trails, GDPR, HIPAA, etc.


## Core Features

### Feature 001

High level feature 001 description

### EFearure 002

High level feature 002 description

...

## OPEN QUESTONS

Questions that need to be resolved before implementaion started.

```

### Product Definition Workflow

```mermaid
sequenceDiagram
    autonumber
    actor U as Business Analyst
    participant R as Repository
    participant C as Claude Code


    %% Discovery & Definition phase
    U->>R: Store the Vision and initial docs in /product/initial-docs/
    U->>C: /define-product <name>
    C->>R: Read initial inputs from /product/initial-docs/
    C-->>U: Ask clarifying questions
    C->>R: Generate /product/product.md with product card, features and open questions

    %% High Level definition verification
    U->>R: User (BA) reviews and validates /product/product.md file, and ensures that no open questions left unanswered.
    U->>R: User commits the product.md file.

```

## Architecture Definition

### Architecture Definiton Template

```text
# Architecture and Deveopment Rules

## General Rules

KISS, ...

## Components

| Companent name | Purpose | Repository | Has UI? |
|----------------|---------|------------|---------|

## Component XXX

Tech Stack:

* Programming Language
* Framework(s)
* Main dependencies
* Database and data migration tools
* Build and package/dependency management tools

Tools: 

* Version control
* CI/CD
* Containerization

Deployment:

* Target Platform (e.g. GCP)
* QA & Release Process

Integrations:

* External APIs, etc.

Tech Design:

Taking into account non-functional requirements, define:

* API type
* DTOs and Persistent Objects
* Concurrency
* Performance


```

### Architecture Definition Workflow

```mermaid
sequenceDiagram
    autonumber
    actor U as Architect
    participant R as Repository
    participant C as ClaudeCode

    U->>C: /define-architecture
    C-->>C: based on product/inital/ folder content and files CLAUDE.md, AGENTS.md architecture.md if they exist, think about architectural optons
    C-->>U: ask clarifying questions on architecture including components, tech stack, coding stlyle
    C-->>R: saves created or updated product/architecture.md

    U->>R: Review and commit the architecture.md
    
```

## Feature Definition

Each High Level Feature or Epic is to be defined in separate folder prefixed by sequence number:
/product/features/000-short_feature_name/

The folder contains documentation related to this feature:

- The main feature.md document, generated by /define-feature command and reviewed and updated by user (BA)
- Additional sub-features or user stories in the form of story-000-name.md files created by user (BA)

Files feature.md and story-000-name.md should following typical JIRA issue template like below:

### Feature Template

Feature and User Story template:

```text
---
Title:
Created Date:
Updated Date:
Status:
---
# Feature Definition

## Description

## User Interface

References to mockups or examples of UI (if the feature includes components that has UI)

## Acceptance Criteria

Definition of Done that can be used to test the feature.

## Open Questions

Questions that should be resolved by the time of implementation.
```

### Featre Definition Workflow

```mermaid
sequenceDiagram
    autonumber
    actor U as Business Analyst
    participant R as Repository
    participant C as Claude Code

    %% Derive features from Product definition
    U->>C: /mvp-features
    C->>R: Read /product/product.md
    C->>C: Identify main features and invoke /define-feature for each one

    %% Add Feature
    U->>C: /add-feature F000-FeatureName
    C->>R: Read the folder content or create new one /product/features/F000-FeatureName/
    C-->>U: Clarify feature requirements with the user (BA)
    C->>R: Generate/update corresponding /product/features/F000-FeatureName/feature.md
    U->>R: BA verifies/updates feature.md content and commits changes in repo
    U->>R: User optionally adds user stories files to the feature folder and commits them

    %% UI Design Mockups
    U->>C: /mockup-feature F000-FeatureName
    C->>C: Generate several mockups using UI Sub-Agent in the form of self-contained html file
    C->>R: Save mockups for user review
    U->>R: User reviews mockups
    U->>C: Optionally re-run /mockup-feature 
    U->>R: user commits selected mockup

    %% Plan feature
    U->>C: /plan-feature F000-FeatureName
    C->>C: Think plan and tasks based on architecture and design mockups
    C-->>U: Ask clarifying questions
    C->>R: Generate product/features/F000-FeatureName/plan.md
    U->>R: User reviews/updates/commits the plan
    
```

## Feature Implementation

```mermaid
sequenceDiagram
    autonumber
    actor U as DEVELOPER
    participant R as Repository
    participant C as Claude Code
    
    %% Implement feature
    U->>C: /implement-feature F001-FeatureName
    C->>R: bash: create feature branch
    C->>R: set feature status to in Progress
    C->>R: generate/update the codebase and mark tasks in plan.md completed, commit after each task

    %% Perform Code Review of the branch changes
    C->>C: review the code on coding style, security and best practices usage

    %% Build and run tests, debug if needed
    C->>C: run build with unit tests

    C->>C: debug on errors and fix code and rerun

    C->>C: use MCP and tools to perform end-to-end tests

    C->>C: verify if acceptance criteria defined in featre met

    C->>R: Commit the code with proper comments, starting with feature id

    C->>R: If there any significant architectural decisions, made during this session for the feature implementation, document it in product/adr/adr-YYYY-MM-DD.md file

    C->>R: set feature status to Done
    
    %% Push and create Pull Request
    C->>R: perform pull (merge) request 
    
```
